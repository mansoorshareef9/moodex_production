(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[476],{66707:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/Quote",function(){return t(10244)}])},10244:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return m}});var o=t(85893),a=t(36465),n=t.n(a),r=t(59734),i=t(4696),l=t(94127),c=t(11163),d=t(67294),f=t(96110),x=t(69077),b=t(6264),u=t.n(b);function m(e){let{price:s,quote:t,setQuote:a,takerAddress:b}=e,m=i.if[s.sellTokenAddress.toLowerCase()],p=i.if[s.buyTokenAddress.toLowerCase()],j="matic"===m.symbol.toLowerCase(),{address:h}=(0,x.mA)(),g=(0,c.useRouter)(),{isLoading:w}=(0,r.ZP)(["/api/quote",{sellToken:s.sellTokenAddress,buyToken:s.buyTokenAddress,sellAmount:s.sellAmount,takerAddress:b,feeRecipient:"0xD86766b68e844E9096662d0E38Bc6d11e803B7Bb",buyTokenPercentageFee:.003}],l.fetcher,{onSuccess:e=>{a(e),console.log("quote",e),console.log((0,f.bM)(e.buyAmount,p.decimals),e)}}),k=j?{to:null==t?void 0:t.to,value:(null==t?void 0:t.sellAmount)?BigInt(t.sellAmount):void 0,data:null==t?void 0:t.data}:{to:null==t?void 0:t.to,value:void 0,data:null==t?void 0:t.data},{sendTransaction:v,data:y,isError:N}=(0,x.pQ)(k),[A,T]=(0,d.useState)("idle"),[_,B]=(0,d.useState)(!1),[E,z]=(0,d.useState)(void 0),C=async e=>{if(e.preventDefault(),console.log("Attempting to send transaction..."),!v){console.error("Transaction not prepared");return}T("pending"),B(!0);try{await v()}catch(e){console.error("Transaction error:",e),"TransactionExecutionError"===e.name||e.message.includes("rejected")?T("rejected"):T("error"),z(void 0)}};(0,d.useEffect)(()=>{y&&z(y.hash),N&&T("error")},[y,N]);let{status:I,error:F}=(0,x.BX)({hash:null==y?void 0:y.hash});return((0,d.useEffect)(()=>{"success"===I?T("success"):"error"===I?T("error"):F&&T("error")},[I,F]),t)?(0,o.jsxs)("div",{className:"jsx-6c7918ef04ad1ffb p-3 mx-auto max-w-screen-sm ",children:[(0,o.jsx)("button",{onClick:()=>{g.reload()},className:"jsx-6c7918ef04ad1ffb bg-dark-200 text-white text-xl font-bold py-2 px-4 rounded mt-4",children:"Go Back"}),(0,o.jsxs)("form",{className:"jsx-6c7918ef04ad1ffb "+(u().form||""),children:[(0,o.jsxs)("div",{className:"jsx-6c7918ef04ad1ffb",children:[(0,o.jsx)("div",{className:"jsx-6c7918ef04ad1ffb text-xl mb-2 text-white",children:"You pay"}),(0,o.jsxs)("div",{className:"jsx-6c7918ef04ad1ffb flex items-center text-lg sm:text-3xl mb-4 text-white",children:[(0,o.jsx)("img",{alt:m.symbol,src:m.logoURI,className:"jsx-6c7918ef04ad1ffb h-9 w-9 mr-2 rounded-md"}),(0,o.jsx)("span",{className:"jsx-6c7918ef04ad1ffb",children:t.sellAmount&&void 0!==m.decimals?(0,f.bM)(BigInt(t.sellAmount),m.decimals):"Invalid Amount"}),(0,o.jsx)("div",{className:"jsx-6c7918ef04ad1ffb ml-2",children:m.symbol})]})]}),(0,o.jsxs)("div",{className:"jsx-6c7918ef04ad1ffb",children:[(0,o.jsx)("div",{className:"jsx-6c7918ef04ad1ffb text-xl mb-2 text-white",children:"You receive"}),(0,o.jsxs)("div",{className:"jsx-6c7918ef04ad1ffb flex items-center text-lg sm:text-3xl mb-4 text-white",children:[(0,o.jsx)("img",{alt:p.symbol,src:p.logoURI,className:"jsx-6c7918ef04ad1ffb h-9 w-9 mr-2 rounded-md"}),(0,o.jsx)("span",{className:"jsx-6c7918ef04ad1ffb",children:t.buyAmount&&void 0!==p.decimals?Number((0,f.bM)(BigInt(t.buyAmount),p.decimals)).toFixed(2):"Invalid Amount"}),(0,o.jsx)("div",{className:"jsx-6c7918ef04ad1ffb ml-2",children:p.symbol})]})]}),(0,o.jsx)("div",{className:"jsx-6c7918ef04ad1ffb",children:(0,o.jsx)("div",{className:"jsx-6c7918ef04ad1ffb text-white mb-3 ",children:t&&t.grossBuyAmount?"Fee: "+(t.grossBuyAmount&&void 0!==p.decimals?(.003*Number((0,f.bM)(BigInt(t.grossBuyAmount),p.decimals))).toFixed(1):"Invalid Amount")+" "+p.symbol:null})}),(0,o.jsx)("button",{onClick:C,className:"jsx-6c7918ef04ad1ffb "+(u().button||""),children:"Swap"})]}),_&&(0,o.jsxs)("div",{className:"jsx-6c7918ef04ad1ffb popup",children:[(0,o.jsxs)("p",{className:"jsx-6c7918ef04ad1ffb status",children:["pending"===A&&"Transaction is pending...","success"===A&&"Transaction successful!","error"===A&&"Transaction failed. Please try again.","rejected"===A&&"Transaction was rejected by the user."]}),("pending"===A||"success"===A)&&E&&(0,o.jsx)("a",{href:"https://polygonscan.com/tx/".concat(E),target:"_blank",rel:"noopener noreferrer",className:"jsx-6c7918ef04ad1ffb external-link",children:"Transaction Hash"}),(0,o.jsx)("button",{onClick:()=>{B(!1),T("idle"),z(void 0),g.reload()},className:"jsx-6c7918ef04ad1ffb close-button",children:"Close"})]}),(0,o.jsx)(n(),{id:"6c7918ef04ad1ffb",children:".popup.jsx-6c7918ef04ad1ffb{position:fixed;top:10%;left:89%;-webkit-transform:translate(-50%,-10%);-moz-transform:translate(-50%,-10%);-ms-transform:translate(-50%,-10%);-o-transform:translate(-50%,-10%);transform:translate(-50%,-10%);width:20%;height:20%;background:rgba(0,0,0,.7);padding:20px;border:1px solid black;z-index:1000;-webkit-border-radius:15px;-moz-border-radius:15px;border-radius:15px;-webkit-box-shadow:0 4px 30px rgba(0,0,0,.1);-moz-box-shadow:0 4px 30px rgba(0,0,0,.1);box-shadow:0 4px 30px rgba(0,0,0,.1);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;text-align:center;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);color:white}.status.jsx-6c7918ef04ad1ffb{margin-bottom:10px;font-size:1.2em}.external-link.jsx-6c7918ef04ad1ffb{color:#f01717;text-decoration:underline;margin-bottom:auto;cursor:pointer}.close-button.jsx-6c7918ef04ad1ffb{margin-top:auto;padding:5px 10px;background-color:#333;color:white;border:none;-webkit-border-radius:5px;-moz-border-radius:5px;border-radius:5px;cursor:pointer}.close-button.jsx-6c7918ef04ad1ffb:hover{background-color:#555}"})]}):(0,o.jsx)("div",{style:{color:"white",fontWeight:"bold"},children:"Getting Final quote..."})}},11163:function(e,s,t){e.exports=t(96885)}},function(e){e.O(0,[129,240,975,774,888,179],function(){return e(e.s=66707)}),_N_E=e.O()}]);